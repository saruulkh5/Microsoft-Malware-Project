
CREATE TABLE City (
    CityID INT IDENTITY PRIMARY KEY,
    CityCode VARCHAR(50)
)

CREATE TABLE Region (
    RegionID INT IDENTITY PRIMARY KEY,
    RegionCode VARCHAR(50)
)

CREATE TABLE Country (
    CountryID INT IDENTITY PRIMARY KEY,
    CountryCode VARCHAR(50)
)

CREATE TABLE GeoLocation (
    GeoID INT IDENTITY PRIMARY KEY,
    GeoCode VARCHAR(50)
)
-- DROP TABLE Location

CREATE TABLE Location (
    LocationID INT IDENTITY PRIMARY KEY,
    CityID INT FOREIGN KEY REFERENCES City(CityID),
    RegionID INT FOREIGN KEY REFERENCES Region(RegionID),
    CountryID INT FOREIGN KEY REFERENCES Country(CountryID),
    GeoID INT FOREIGN KEY REFERENCES GeoLocation(GeoID)
)

-- DONE
INSERT INTO City (CityCode)
SELECT DISTINCT CityIdentifier FROM tblWorkingCopy

-- ORDER BY CityIdentifier -- SELECT * FROM City
-- DONE
INSERT INTO Region (RegionCode)
SELECT DISTINCT GeoNameIdentifier FROM tblWorkingCopy ORDER BY GeoNameIdentifier -- SELECT * FROM Region
-- DONE
INSERT INTO Country (CountryCode)
SELECT DISTINCT CountryIdentifier FROM tblWorkingCopy ORDER BY CountryIdentifier -- SELECT * FROM Country
-- DONE
INSERT INTO GeoLocation (GeoCode)
SELECT DISTINCT Wdft_RegionIdentifier FROM tblWorkingCopy ORDER BY Wdft_RegionIdentifier -- SELECT * FROM GeoLocation


